#include<stdio.h>
#include<stdlib.h>
#include<math.h>
int findgcd(int n1,int n2)
{
 int i,gcd;
 for(i=1;i<=n1&&i<=n2;i++)
 {
 if(n1%i==0&&n2%i==0)
 gcd=i;
 }
 return gcd;
}
int power(int a,int b,int n)
{
 long long x=1,y=a;
 while(b>0)
 {
 if(b%2==1)
 x=(x*y)%n;
 y=(y*y)%n;
 b/=2;
 }
 return x%n;
}
int main()
{
 int p,q;
 int pi,m,n,e,d;
 printf("enter values for p and q:\n");
 scanf("%d",&p);
 scanf("%d",&q);
 n=p*q;
 pi=(p-1)*(q-1);
 for(e=5;e<=pi;e++)
 {
 if(findgcd(pi,e)==1)
 break;
 }
 for(d=e;d<=pi;d++)
 {
 if((d*e)%pi==1)
 break;
 }
 printf("enter the plain text M:\n");
 scanf("%d",&m);
 int ct=power(m,e,n);
 printf("encryption:\n");
 printf("%d\n",ct);
 int m1=power(ct,d,n);
 printf("decryption:\n");
 printf("%d\n",m1);
 return 0;
}
OUTPUT:
enter values for p and q:
17
11
enter the plain text M:
88
encryption:
11
decryption:
88