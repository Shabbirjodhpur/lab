#include<stdio.h>
#include<math.h>
void main()
{
int q,alpha,xa,xb,ya,yb,ka,kb;
printf("Enter a prime number : ");
scanf("%d",&q);
printf("Enter the primitive root of q : ");
scanf("%d",&alpha);
printf("Enter a private key of user A : ");
scanf("%d",&xa);
printf("Enter a private key of user B : ");
scanf("%d",&xb);
ya=(int)pow(alpha,xa)%q;
yb=(int)pow(alpha,xb)%q;
ka=(int)pow(yb,xa)%q;
printf("Secret key generated by user A : %d \n",ka);
kb=(int)pow(ya,xb)%q;
printf("Secret key generated by user B : %d \n",kb);
if(ka==kb)
printf("keys are same");
}